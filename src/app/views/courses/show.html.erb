<% if !@course.approved? %>
<div class="alert alert-info">
  <% if can? :approve, @course %>
  <%= link_to 'approve course', approve_course_path(@course), class: 'btn btn-success' %>
  <%= link_to 'delete course', @course, class: 'btn btn-danger', confirm: 'Are you sure that you want to delete this course?', method: :delete %>
  <% end %>
  This course was suggested and will be checked by our moderators. You can still interact with this course like with approved courses. 
</div>
<% end %>

<div class="hero-unit">
  <h2>
    <%= " #{@course.name}" %>
    <small><%=link_to "(#{@course.term.code})", term_path(@course.term) %></small>
  </h2>
  <% unless @course.description.nil? or @course.description.empty? %>
      <p class="lead"><%= markdown(@course.description) %></p>
      <% else %>
      <%= link_to 'Add a description to the course', edit_course_path(@course) if can? :manage, @course %> 
    <% end %>
</div>

<div class="row-fluid">
  <div class="span6 well">
    <h3>Announcements 
      <% if current_user and current_user.may_edit_course(@course) %>
        <%= link_to 'Make an announcement', new_post_path(:post_type => 'info', :course_id => @course.id), :class => 'btn btn-warning btn-mini pull-right' %>
      <% end %> </h3>

    <%= render 'courses/announcement_overview'%>
  </div>

  <div class='span<%= current_user.may_edit_course(@course) ? '3' : '4' %> well'>
    <h3>About</h3>
    <b>Membership</b>
    <div class='<%= "follow-button follow-button-#{@course.id}" %>'>
      <%= render :partial => 'shared/follow_button', :locals => { :course => @course } %>
    </div>
    <hr />
    <p>
      <b>website</b> 
      <% if @course.url.empty? %>
        <%= (can? :manage, @course) ? (link_to 'add url to the course', edit_course_path(@course)) : 'Not available yet' %>  
      <% else %>
      <%= link_to @course.url, @course.url %></p> 
      <% end %>
    </p>
    <div class="member-list">
      <%= render 'courses/member-list' %>
    </div>
  </div>

  <% if can? :manage, @course %>
    <div class="span3 well">
      <h3>Manage course</h3>
      <% if can? :manage, User %>
      <p><%= link_to content_tag('span', ' manage users', :class=> 'icon-user'), '#manage-users-modal', 'data-toggle'=>"modal", :class => 'btn btn-primary maintainer-button' %></p>
      <% end %>
      <p><%= link_to content_tag('span', ' edit course', :class=>'icon-edit'), edit_course_path(@course), :class => 'btn maintainer-button'  %>
      </p>
      <p><%= link_to content_tag('span', ' add new semester', :class=> 'icon-plus'), new_course_path(:course => @course), :class => 'btn maintainer-button'  %></p>
      <% if can? :delete, @course %>
      <p><%= link_to content_tag('span', ' delete course', :class=>'icon-trash'), @course, confirm: 'Are you sure that you want to delete this course?', method: :delete, :class => 'btn btn-danger maintainer-button' %></p>
      <% end %>
    </div>
  <% else %>
    <div class="span2 well">
      <h3>Questions?</h3>
      <p><%= link_to 'Ask a public question', new_post_path(:post_type => 'question', :course_id => @course.id), :class => 'btn btn-primary communicate-button' %></p>
      <p><%= link_to 'Ask a private question', new_post_path(:post_type => 'question', :course_id => @course.id, :is_private => true), class: 'btn communicate-button' %></p>
    </div>
  <% end %>
   
</div>
<hr />
<section id="question_stream">
  <div class="center span8">
      <h3>
        Questions?
        <% if user_signed_in? %>
          <small>
            <%= link_to 'Ask a public question', new_post_path(:post_type => 'question', :course_id => @course.id), :class => 'inline-button btn btn-mini btn-primary' %>
            <%= link_to 'Ask a private question', new_post_path(:post_type => 'question', :course_id => @course.id, :is_private => true), class: 'inline-button btn btn-mini' %>
          </small>
        <% end %>
        <p class="pull-right"><small>sorted by last activity</small></p>
        <hr />
      </h3>

    <div id="question-stream">
      <%= render 'courses/question_stream' %>
    </div>
  </div>
</section>

<% if can? :manage, User %>
<%= render :partial => 'courses/manage_users_modal', :locals => { :course => @course }%>
<% end %>
  
